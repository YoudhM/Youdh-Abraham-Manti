---
title: "Client Report - [Coding Challenge]"
subtitle: "Course DS 250"
author: "[Youdh Manti]"
format:
  html:
    self-contained: true
    page-layout: full
    title-block-banner: true
    toc: true
    toc-depth: 3
    toc-location: body
    number-sections: false
    html-math-method: katex
    code-fold: true
    code-summary: "Show the code"
    code-overflow: wrap
    code-copy: hover
    code-tools:
        source: false
        toggle: true
        caption: See code
execute: 
  warning: false
    
---
__Q1__

```{python}
import pandas as pd
import matplotlib.pyplot as plt
df = pd.read_csv(
    "https://raw.githubusercontent.com/byuidatascience/data4names/master/data-raw/names_year/names_year.csv")

df = df[df["name"] == "Peter"]
plt.figure(figsize=(14,6))
plt.plot(df["year"], df["UT"], color="red", label="Utah")
plt.plot(df["year"], df["OR"], color="orange", label="Oregon")

for y in [1936, 1972, 2005]:
    plt.axvline(y, color="black")
    plt.text(y, max(df["UT"].max(), df["OR"].max())*0.95, y, ha="center")
plt.title("The history of Peter for Utah (red) and Oregon (orange)")
plt.xlabel("Year name given")
plt.ylabel("Count of Peter")
plt.grid(True)
plt.legend()
plt.show()
```

__Q2__

```{python}
import pandas as pd
import numpy as np

problem = pd.Series(['N/A', 15, 22, 45, 31, -999, 21, 2, 0, 0, 0, 'broken'])
cleaned = pd.to_numeric(problem, errors="coerce").replace(-999, np.nan)
print(f"{cleaned.std():.2f}")
```

__Q3__

```{python}
import pandas as pd
import plotly.express as px
df = pd.read_json(
    "https://raw.githubusercontent.com/byuidatascience/data4missing/master/data-raw/flights_missing/flights_missing.json")

month_dict = {
    "January":1, "Febuary":2, "March":3, "April":4,
    "May":5, "June":6, "July":7, "August":8,
    "September":9, "October":10, "November":11, "December":12}
df["month"] = df["month"].map(month_dict)
fig = px.histogram(df, x="month", title="Flights by Month")
fig.show()
```

__Q4__

```{python}
import pandas as pd
import numpy as np
import plotly.express as px
from sklearn.model_selection import train_test_split
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.metrics import accuracy_score
df = pd.read_json(
    "https://raw.githubusercontent.com/byuidatascience/data4missing/master/data-raw/flights_missing/flights_missing.json")

for c in ["minutes_delayed_carrier", "minutes_delayed_nas"]:
    df[c] = pd.to_numeric(df[c], errors="coerce").replace(-999, np.nan)
    df[c] = df[c].fillna(df[c].median())
df = df[df["month"].notna()]
X = df.select_dtypes(include=np.number).drop(columns=["year"])
y = df["month"]
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.33, random_state=1936)
model = GradientBoostingClassifier()
model.fit(X_train, y_train)

print(f"Accuracy: {accuracy_score(y_test, model.predict(X_test)):.2%}")
imp = pd.DataFrame({
    "Feature": X.columns,
    "Importance": model.feature_importances_
}).nlargest(10, "Importance")
px.bar(imp, x="Importance", y="Feature", orientation="h",
       title="Top 10 Feature Importances").show()
```
